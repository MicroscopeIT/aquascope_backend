openapi: 3.0.0
info:
  description: Aquascope Virtum API
  version: 0.1.0
  title: aquascope-virtum
  contact:
    email: aleksander.cieslak@microscopeit.com
servers:
  - url: 'http://localhost/'

paths:
  /user/login:
    post:
      description: 'Login user using username and password (in plaintext). Returns access_token and refresh_token'
      operationId: login
      tags:
        - User
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  access_token:
                    type: string
                  refresh_token:
                    type: string
        '400':
          description: 'Unknown arguments'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnknownArgumentsResult'

        '401':
          description: 'Wrong credentials'
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '500':
          description: 'Server error. Most likely wrong hash used for storing password is malformed'
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
  /user/refresh:
    post:
      description: 'Refreshing access_token using authorisation with refresh_token'
      operationId: refresh
      tags:
        - User
      security:
        - refreshBearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string


  /user/list:
    get:
      description: 'Obtains lists of users'
      operationId: get_user_list
      tags:
        - User
      security:
        - refreshBearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserList'

  /user/new:
    post:
      description: 'Adds new user to the system'
      operationId: post_user
      tags:
        - User
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostUser'

      responses:
        '204':
          description: OK
        '400':
          description: Unknown arguments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnknownArgumentsResult'
        '401':
          description: Username taken
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UsernameTaken'

  /sas:
    get:
      description: 'Obtains SAS, which is data access token. Obtained token should be appended to every `url` field from API response bodies'
      operationId: get_sas
      tags:
        - Sas
      security:
       - bearerAuth: []
      parameters:
        - name: destination
          description: Specifies SAS's destination. `processed` should be used to obtain data from `/items GET` respone. `upload` should be used to obtain access to upload. `download` should be used to obtain data from `/download/<id> GET` response.
          in: query
          required: true
          schema:
            type: string
            enum: [processed, upload, download]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SasResult'

        '400':
          description: 'Invalid choice'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadSasResponses'
          examples:
            InvalidSasChoice:
              message:
                destination: <destination> is not a valid choice
            UnknownArgumentsResult:
              message: "Unknown arguments: <arguments>"

  /items/paged:
    get:
      description: 'Obtains list of data samples that match provided query'
      operationId: get_paged_items
      tags:
        - Items
      security:
        - bearerAuth: []
      parameters:
        - name: continuation_token
          in: query
          required: false
          schema:
            type: integer
            example: 1
        - name: empire
          in: query
          required: false
          schema:
            type: string
            example: 'prokaryota'
        - name: kingdom
          in: query
          required: false
          schema:
            type: string
            example: 'Bacteria'
        - name: phylum
          in: query
          required: false
          schema:
            type: string
            example: 'Cyanobacteria'
        - name: class
          in: query
          required: false
          schema:
            type: string
            example: 'Cyanophyceae'
        - name: order
          in: query
          required: false
          schema:
            type: string
            example: 'Nostocales'
        - name: family
          in: query
          required: false
          schema:
            type: string
            example: 'Nostocaceae'
        - name: genus
          in: query
          required: false
          schema:
            type: string
            example: 'Anabaena'
        - name: species
          in: query
          required: false
          schema:
            type: string
            example: 'sp'
        - name: filename
          in: query
          required: false
          schema:
            type: string
            example: 'images_00000_SPC-EAWAG-5P0X-15433639.*'
        - name: acquisition_time_start
          in: query
          required: false
          schema:
            type: string
            example: '2019-01-26 00:00:00.000Z'
        - name: acquisition_time_end
          in: query
          required: false
          schema:
            type: string
            example: '2019-01-27 00:00:00.000Z'
        - name: with_eggs
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dividing
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dead
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_epibiont
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_parasite
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: broken
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: colony
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: cluster
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: eating
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: multiple_species
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: partially_cropped
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: male
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: female
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: juvenile
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: adult
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: ephippium
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: resting_egg
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: heterocyst
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: akinete
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_spines
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: beatles
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: stones
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: zeppelin
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: floyd
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: acdc
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: hendrix
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: alan_parsons
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: allman
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dire_straits
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: eagles
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: guns
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: purple
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: van_halen
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: skynyrd
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: zz_top
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: iron
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: police
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: moore
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: inxs
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: chilli_peppers
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true

      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedItemsQueryResult'
        '400':
          description: Unknown arguments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnknownArgumentsResult'

  /export:
    get:
      description: 'Obtains url handle for data exported from the system'
      operationId: get_export
      tags:
        - Export
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            example: 4
        - name: empire
          in: query
          required: false
          schema:
            type: string
            example: 'prokaryota'
        - name: kingdom
          in: query
          required: false
          schema:
            type: string
            example: 'Bacteria'
        - name: phylum
          in: query
          required: false
          schema:
            type: string
            example: 'Cyanobacteria'
        - name: class
          in: query
          required: false
          schema:
            type: string
            example: 'Cyanophyceae'
        - name: order
          in: query
          required: false
          schema:
            type: string
            example: 'Nostocales'
        - name: family
          in: query
          required: false
          schema:
            type: string
            example: 'Nostocaceae'
        - name: genus
          in: query
          required: false
          schema:
            type: string
            example: 'Anabaena'
        - name: species
          in: query
          required: false
          schema:
            type: string
            example: 'sp'
        - name: filename
          in: query
          required: false
          schema:
            type: string
            example: 'images_00000_SPC-EAWAG-5P0X-15433639.*'
        - name: acquisition_time_start
          in: query
          required: false
          schema:
            type: string
            example: '2019-01-26 00:00:00.000Z'
        - name: acquisition_time_end
          in: query
          required: false
          schema:
            type: string
            example: '2019-01-27 00:00:00.000Z'
        - name: with_eggs
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dividing
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dead
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_epibiont
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_parasite
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: broken
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: colony
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: cluster
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: eating
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: multiple_species
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: partially_cropped
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: male
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: female
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: juvenile
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: adult
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: ephippium
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: resting_egg
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: heterocyst
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: akinete
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_spines
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: beatles
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: stones
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: zeppelin
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: floyd
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: acdc
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: hendrix
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: alan_parsons
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: allman
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dire_straits
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: eagles
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: guns
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: purple
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: van_halen
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: skynyrd
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: zz_top
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: iron
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: police
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: moore
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: inxs
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: chilli_peppers
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true

      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportResult'
        '400':
          description: Unknown arguments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnknownArgumentsResult'


  /items:
    post:
      description: 'Updates data samples'
      operationId: post_items
      tags:
        - Items
      security:
       - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemsUpdate'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemsUpdateResult'


    get:
      description: 'Obtains list of data samples that match provided query'
      operationId: get_items
      tags:
        - Items
      security:
        - bearerAuth: []
      parameters:
        - name: empire
          in: query
          required: false
          schema:
            type: string
            example: 'prokaryota'
        - name: kingdom
          in: query
          required: false
          schema:
            type: string
            example: 'Bacteria'
        - name: phylum
          in: query
          required: false
          schema:
            type: string
            example: 'Cyanobacteria'
        - name: class
          in: query
          required: false
          schema:
            type: string
            example: 'Cyanophyceae'
        - name: order
          in: query
          required: false
          schema:
            type: string
            example: 'Nostocales'
        - name: family
          in: query
          required: false
          schema:
            type: string
            example: 'Nostocaceae'
        - name: genus
          in: query
          required: false
          schema:
            type: string
            example: 'Anabaena'
        - name: species
          in: query
          required: false
          schema:
            type: string
            example: 'sp'
        - name: filename
          in: query
          required: false
          schema:
            type: string
            example: 'images_00000_SPC-EAWAG-5P0X-15433639.*'
        - name: acquisition_time_start
          in: query
          required: false
          schema:
            type: string
            example: '2019-01-26 00:00:00.000Z'
        - name: acquisition_time_end
          in: query
          required: false
          schema:
            type: string
            example: '2019-01-27 00:00:00.000Z'
        - name: with_eggs
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dividing
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dead
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_epibiont
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_parasite
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: broken
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: colony
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: cluster
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: eating
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: multiple_species
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: partially_cropped
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: male
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: female
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: juvenile
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: adult
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: ephippium
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: resting_egg
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: heterocyst
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: akinete
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: with_spines
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: beatles
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: stones
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: zeppelin
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: floyd
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: acdc
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: hendrix
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: alan_parsons
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: allman
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: dire_straits
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: eagles
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: guns
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: purple
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: van_halen
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: skynyrd
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: zz_top
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: iron
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: police
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: moore
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: inxs
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true
        - name: chilli_peppers
          in: query
          required: false
          schema:
            type: array
            items:
              type: boolean
              nullable: true

      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemsQueryResult'
        '400':
          description: Unknown arguments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnknownArgumentsResult'


  /upload/{filename}:
    put:
      description: 'Data upload handle'
      operationId: put_upload
      tags:
        - Upload
      security:
        - bearerAuth: []
      parameters:
        - name: filename
          in: path
          required: true
          schema:
            type: string

      responses:
        '204':
          description: OK

  /upload/list:
    get:
      description: 'Obtains list of uploads'
      operationId: get_upload_list
      tags:
        - Upload
      security:
       - bearerAuth: []

      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadListResult'


components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    refreshBearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Item:
      properties:
        _id:
          type: string
        filename:
          type: string
        extension:
          type: string
        group_id:
          type: string
        empire:
          type: string
        kingdom:
          type: string
        phylum:
          type: string
        class:
          type: string
        order:
          type: string
        family:
          type: string
        genus:
          type: string
        species:
          type: string
        acquisition_time:
          type: string
          format: date-time
        image_width:
          type: integer
        image_height:
          type: integer
        with_eggs:
          type: boolean
          nullable: true
        dividing:
          type: boolean
          nullable: true
        dead:
          type: boolean
          nullable: true
        with_epibiont:
          type: boolean
          nullable: true
        with_parasite:
          type: boolean
          nullable: true
        broken:
          type: boolean
          nullable: true
        colony:
          type: boolean
          nullable: true
        cluster:
          type: boolean
          nullable: true
        eating:
          type: boolean
          nullable: true
        multiple_species:
          type: boolean
          nullable: true
        partially_cropped:
          type: boolean
          nullable: true
        male:
          type: boolean
          nullable: true
        female:
          type: boolean
          nullable: true
        juvenile:
          type: boolean
          nullable: true
        adult:
          type: boolean
          nullable: true
        ephippium:
          type: boolean
          nullable: true
        resting_egg:
          type: boolean
          nullable: true
        heterocyst:
          type: boolean
          nullable: true
        akinete:
          type: boolean
          nullable: true
        with_spines:
          type: boolean
          nullable: true
        beatles:
          type: boolean
          nullable: true
        stones:
          type: boolean
          nullable: true
        zeppelin:
          type: boolean
          nullable: true
        floyd:
          type: boolean
          nullable: true
        acdc:
          type: boolean
          nullable: true
        hendrix:
          type: boolean
          nullable: true
        alan_parsons:
          type: boolean
          nullable: true
        allman:
          type: boolean
          nullable: true
        dire_straits:
          type: boolean
          nullable: true
        eagles:
          type: boolean
          nullable: true
        guns:
          type: boolean
          nullable: true
        purple:
          type: boolean
          nullable: true
        van_halen:
          type: boolean
          nullable: true
        skynyrd:
          type: boolean
          nullable: true
        zz_top:
          type: boolean
          nullable: true
        iron:
          type: boolean
          nullable: true
        police:
          type: boolean
          nullable: true
        moore:
          type: boolean
          nullable: true
        inxs:
          type: boolean
          nullable: true
        chilli_peppers:
          type: boolean
          nullable: true
        file_size:
          type: number
          format: float
        aspect_ratio:
          type: number
          format: float
        maj_axis_len:
          type: number
          format: float
        min_axis_len:
          type: number
          format: float
        orientation:
          type: number
          format: float
        eccentricity:
          type: number
          format: float
        solidity:
          type: number
          format: float
        estimated_volume:
          type: number
          format: float
        area:
          type: number
          format: float

    ListOfItems:
      type: array
      items:
        $ref: '#/components/schemas/Item'
    ListOfUrls:
      type: array
      items:
        type: string
        format: url
    ItemsQueryResult:
      type: object
      required: [items, urls]
      properties:
        items:
          $ref: '#/components/schemas/ListOfItems'
        urls:
          $ref: '#/components/schemas/ListOfUrls'
    PagedItemsQueryResult:
      type: object
      required: [items, urls]
      properties:
        items:
          $ref: '#/components/schemas/ListOfItems'
        urls:
          $ref: '#/components/schemas/ListOfUrls'
        continuation_token:
          type: integer
    UnknownArgumentsResult:
      type: object
      properties:
        message:
          type: array
          items:
            type: object
            properties:
              parameters:
                type: string
              errors:
                type: array
                items:
                  type: string
    ItemsUpdate:
      type: array
      items:
        properties:
          current:
              $ref: '#/components/schemas/Item'
          update:
              $ref: '#/components/schemas/Item'
    ItemsUpdateResult:
      properties:
        matched:
          type: integer
        modified:
          type: integer
    SasResult:
      properties:
        token:
          type: string
          format: url
    InvalidSasChoice:
      properties:
        message:
          properties:
            destination:
              type: string
              example: '<destination> is not a valid choice'
    BadSasResponses:
      description: SwaggerUI doesn't know how to render oneOf
      type: object
      oneOf:
        - $ref: '#/components/schemas/InvalidSasChoice'
        - $ref: '#/components/schemas/UnknownArgumentsResult'
    UploadListResult:
      type: array
      items:
        properties:
          _id:
            type: string
          filename:
            type: string
          state:
            type: string
            enum: [initialized, uploaded, processing, finished, failed]
          generation_date:
            type: string
            format: date-time
    ExportResult:
      type: object
      required: [status]
      properties:
        status:
          type: string
          enum: [ok, empty]
        url:
          type: string
          format: url
    UserList:
      type: array
      items:
        properties:
          username:
            type: string
    PostUser:
      type: object
      properties:
        username:
          type: string
          pattern: '^[a-zA-Z0-9.]{1,64}$'
    UsernameTaken:
      type: object
      properties:
        message:
          type: string
          example: 'User already exists in the system'

tags:
  - name: User
    description: Endpoints responsible for login and token management
  - name: Items
    description: Endpoints responsible for items (data samples) management
  - name: Sas
    description: Endpoints responsible for SAS tokens (data access tokens) management
  - name: Upload
    description: Endpoints responsible for upload files management
  - name: Export
    description: Endpoints responsible for data export
